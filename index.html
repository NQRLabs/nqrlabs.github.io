<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Tools for puzzle solvers and ARG creators in the CLU community. Explore mysteries, build interactive stories, and unlock hidden layers.">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#0b1220">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#04070a">

  <meta property="og:title" content="NQR Labs">
  <meta property="og:description" content="Tools for puzzle solvers and ARG creators in the CLU community.">
  <meta property="og:image" content="https://projects.nqrlabs.com/assets/images/android-chrome-512x512.png">
  <meta property="og:url" content="https://projects.nqrlabs.com/">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="NQR Labs">
  <meta name="twitter:description" content="Tools for puzzle solvers and ARG creators in the CLU community.">
  <meta name="twitter:image" content="https://projects.nqrlabs.com/assets/images/android-chrome-512x512.png">

  <title>NQR Labs Projects</title>

  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/images/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/assets/images/android-chrome-512x512.png">
  <link rel="shortcut icon" href="/assets/images/favicon-32x32.png">

  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background-color: #04070a;
      color: #d7e8ff;
      line-height: 1.6;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 40px;
      border-bottom: 1px solid rgba(0,255,170,0.15);
    }
    header img {
      height: 48px;
    }
    nav a {
      margin-left: 20px;
      color: #5de1ff;
      text-decoration: none;
      font-weight: bold;
      transition: 0.2s ease-in-out;
    }
    nav a:hover {
      color: #00ffaa;
    }

    /* Neon shimmer for header nav links */
    header nav a {
      position: relative;
      display: inline-block;
      overflow: hidden;
      text-shadow: 0 0 0 rgba(0, 255, 170, 0);
    }
    
    header nav a::after {
      content: "";
      position: absolute;
      left: -120%;
      bottom: -2px;
      width: 120%;
      height: 2px;
      background: linear-gradient(90deg, rgba(0,255,170,0) 0%, rgba(0,255,170,0.9) 35%, rgba(93,225,255,0.9) 65%, rgba(0,255,170,0) 100%);
      opacity: 0;
      transform: translateZ(0);
    }
    
    @keyframes nqrShimmer {
      0%   { left: -120%; opacity: 0; }
      10%  { opacity: 1; }
      50%  { left: 0%; }
      90%  { opacity: 1; }
      100% { left: 120%; opacity: 0; }
    }
    
    header nav a:hover,
    header nav a:focus-visible {
      color: #00ffaa;
      text-shadow:
        0 0 6px rgba(0,255,170,0.35),
        0 0 14px rgba(93,225,255,0.25);
    }
    
    header nav a:hover::after,
    header nav a:focus-visible::after {
      animation: nqrShimmer 1.2s ease-out forwards;
    }
    
    @media (prefers-reduced-motion: reduce) {
      header nav a::after { display: none; }
      header nav a,
      header nav a:hover,
      header nav a:focus-visible {
        transition: none !important;
        text-shadow: none !important;
      }
    }
    
    .hero {
      text-align: center;
      padding: 100px 20px;
      background: linear-gradient(135deg, #00111a, #000000);
    }
    .hero h1 {
      font-size: 3rem;
      margin: 0;
      color: #5de1ff;
    }
    .hero h2 {
      color: #00ffaa;
      font-size: 1.4rem;
      margin-top: 10px;
    }
    .hero p {
      max-width: 700px;
      margin: 20px auto;
      font-size: 1.2rem;
      color: #97f3d2;
    }
    .cta-btn {
      display: inline-block;
      margin-top: 30px;
      padding: 14px 34px;
      font-size: 1.1rem;
      border: none;
      border-radius: 6px;
      background: #0077ff;
      color: #fff;
      cursor: pointer;
      text-decoration: none;
      transition: 0.25s;
    }
    .cta-btn:hover {
      background: #00bb88;
      transform: translateY(-2px) scale(1.03);
    }
    .section-title {
      text-align: center;
      margin: 80px 0 20px;
      font-size: 2rem;
      color: #5de1ff;
    }
    .section-sub {
      text-align: center;
      margin: 0 0 40px;
      font-size: 1rem;
      color: #97f3d2;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 30px;
      padding: 0 40px 80px;
    }

    .card {
      position: relative;
      overflow: hidden;
      background-color: #0c1318;
      border: 1px solid rgba(0,255,170,0.15);
      border-radius: 10px;
      padding: 25px;
      text-align: center;
      transition: border-color 0.25s, transform 0.25s, box-shadow 0.25s;
      cursor: pointer;
    }
    
    .card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: #5de1ff;
      box-shadow: 0 8px 20px rgba(0,255,170,0.1);
    }
    
    .card.has-bg {
      background-color: #0c1318;
    }
    
    .card.has-bg::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image: var(--bg);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      filter: blur(6px) brightness(0.4);
      z-index: 0;
      transition: filter 0.3s ease;
    }
    
    .card.has-bg:hover::before {
      filter: blur(4px) brightness(0.55);
    }
    
    .card > * {
      position: relative;
      z-index: 1;
    }
    
    .card-link-visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      white-space: nowrap;
      border: 0;
    }
    .about {
      max-width: 900px;
      margin: 0 auto 100px;
      font-size: 1.1rem;
      padding: 0 20px;
      text-align: center;
      color: #97f3d2;
    }
    footer {
      text-align: center;
      padding: 30px;
      font-size: 0.9rem;
      border-top: 1px solid rgba(0,255,170,0.15);
      color: #4da8a1;
    }
    footer a {
      color: #5de1ff;
      margin: 0 10px;
      text-decoration: none;
    }
    footer a:hover {
      color: #00ffaa;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
      }
    }
    
    .reveal {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }
    
    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* IFRAME VIEWER */
    #iframe-viewer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #04070a;
      z-index: 9999;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #iframe-viewer.active {
      display: block;
      opacity: 1;
    }

    #content-frame {
      width: 100%;
      height: 100%;
      border: none;
      background: #fff;
    }

    /* NAVIGATION SIDEBAR */
    #nav-sidebar {
      position: fixed;
      left: -280px;
      top: 0;
      width: 280px;
      height: 100%;
      background: linear-gradient(180deg, #0c1318 0%, #04070a 100%);
      border-right: 1px solid rgba(0,255,170,0.2);
      z-index: 10000;
      transition: left 0.3s ease;
      overflow-y: auto;
      box-shadow: 4px 0 20px rgba(0,0,0,0.5);
    }

    #nav-sidebar.open {
      left: 0;
    }

    .nav-toggle {
      position: fixed;
      left: 10px;
      top: 10px;
      width: 50px;
      height: 50px;
      background: rgba(12,19,24,0.95);
      border: 1px solid rgba(0,255,170,0.3);
      border-radius: 8px;
      cursor: pointer;
      z-index: 10001;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .nav-toggle:hover {
      background: rgba(0,255,170,0.1);
      border-color: #00ffaa;
    }

    .hamburger {
      width: 24px;
      height: 18px;
      position: relative;
    }

    .hamburger span {
      display: block;
      position: absolute;
      height: 2px;
      width: 100%;
      background: #5de1ff;
      border-radius: 2px;
      opacity: 1;
      left: 0;
      transition: 0.25s ease-in-out;
    }

    .hamburger span:nth-child(1) {
      top: 0px;
    }

    .hamburger span:nth-child(2) {
      top: 8px;
    }

    .hamburger span:nth-child(3) {
      top: 16px;
    }

    .nav-toggle.open .hamburger span:nth-child(1) {
      top: 8px;
      transform: rotate(135deg);
    }

    .nav-toggle.open .hamburger span:nth-child(2) {
      opacity: 0;
      left: -60px;
    }

    .nav-toggle.open .hamburger span:nth-child(3) {
      top: 8px;
      transform: rotate(-135deg);
    }

    .nav-header {
      padding: 30px 20px 20px;
      border-bottom: 1px solid rgba(0,255,170,0.15);
      text-align: center;
    }

    .nav-header img {
      height: 40px;
      margin-bottom: 10px;
    }

    .nav-header h3 {
      margin: 0;
      color: #5de1ff;
      font-size: 1.2rem;
    }

    .nav-section {
      padding: 20px;
    }

    .nav-section-title {
      font-size: 0.85rem;
      color: #4da8a1;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      font-weight: bold;
    }

    .nav-link {
      display: block;
      padding: 12px 15px;
      margin-bottom: 8px;
      color: #97f3d2;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.2s ease;
      border: 1px solid transparent;
    }

    .nav-link:hover {
      background: rgba(0,255,170,0.1);
      border-color: rgba(0,255,170,0.3);
      color: #00ffaa;
      transform: translateX(5px);
    }

    .nav-link.primary {
      background: rgba(0,119,255,0.2);
      border-color: rgba(0,119,255,0.4);
      color: #5de1ff;
      font-weight: bold;
    }

    .nav-link.primary:hover {
      background: rgba(0,187,136,0.2);
      border-color: #00ffaa;
    }

    /* MODALS */
    .modal {
      display: none;
      position: fixed;
      z-index: 20000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: linear-gradient(135deg, #0c1318 0%, #04070a 100%);
      border: 2px solid rgba(0,255,170,0.3);
      border-radius: 12px;
      padding: 40px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 0 40px rgba(0,255,170,0.2);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(0,255,170,0.15);
    }

    .modal-title {
      font-size: 1.8rem;
      color: #5de1ff;
      margin: 0;
    }

    .close-btn {
      background: none;
      border: none;
      color: #97f3d2;
      font-size: 2rem;
      cursor: pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .close-btn:hover {
      background: rgba(255,0,0,0.2);
      color: #ff5555;
      transform: rotate(90deg);
    }

    .modal-body {
      color: #97f3d2;
      line-height: 1.8;
    }

    .modal-body h3 {
      color: #00ffaa;
      margin-top: 20px;
      margin-bottom: 10px;
    }

    .modal-body p {
      margin-bottom: 15px;
    }

    .modal-body a {
      color: #5de1ff;
      text-decoration: none;
      border-bottom: 1px solid rgba(93,225,255,0.3);
      transition: all 0.2s ease;
    }

    .modal-body a:hover {
      color: #00ffaa;
      border-bottom-color: #00ffaa;
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      background: rgba(0,255,170,0.15);
      border: 1px solid rgba(0,255,170,0.3);
      border-radius: 12px;
      font-size: 0.85rem;
      color: #00ffaa;
      margin-right: 8px;
      margin-bottom: 8px;
    }

    /* Main content wrapper */
    #main-content {
      transition: opacity 0.3s ease;
    }

    #main-content.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
        padding: 0 20px 40px;
      }
      
      header {
        padding: 15px 20px;
        flex-direction: column;
        gap: 15px;
      }
      
      nav a {
        margin: 0 10px;
      }
      
      .hero h1 {
        font-size: 2rem;
      }
      
      #nav-sidebar {
        width: 100%;
        left: -100%;
      }
    }
  </style>
</head>

<body>

<!-- Main Content (cards view) -->
<div id="main-content">
  <header>
    <img id="home" src="./assets/images/logo.png" alt="NQR Labs Logo">
    <nav>
      <a href="https://www.youtube.com/@CLU-NQR" target="_blank">YouTube</a>
      <a href="https://discord.gg/HT9YE8rvuN" target="_blank">Discord</a>
      <a href="https://github.com/NQRLabs" target="_blank">GitHub</a>
    </nav>
  </header>

  <section class="hero">
    <h1>NQR Labs</h1>
    <h2>Where puzzles evolve, and mysteries are engineered</h2>
    <p>Build your skills, create new challenges, and reveal what hides beneath the surface. The CLU community hunts secrets together, experiments with story and signal, and pushes the craft of interactive mysteries forward.</p>
  </section>

  <!-- Player Section -->
  <section id="player-tools" class="reveal">
    <h2 class="section-title">Player Tools</h2>
    <p class="section-sub">Discover hidden layers and sharpen your instincts.</p>
    <div class="grid">
      <div class="card has-bg" style="--bg: url('./assets/images/SpectroGhost_card.png')" data-app="SpectroGhost" data-internal-Link="/SpectroGhost/">
        <h3>SpectroGhost</h3>
        <p>Hunt secret messages inside sound with real-time spectrogram exploration.</p>
        <a href="/SpectroGhost/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/ReSounder_card.png')" data-app="ReSounder" data-internal-Link="/ReSounder/">
        <h3>ReSounder</h3>
        <p>Rebuild audio from spectrograms to test hidden sound puzzles.</p>
        <a href="/ReSounder/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/GlyphGrid_card.png')" data-app="GlyphGrid" data-internal-Link="/GlyphGrid/">
        <h3>GlyphGrid</h3>
        <p>Crack cryptograms with intelligent mapping and visual letter tracking.</p>
        <a href="/GlyphGrid/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/Ghostmark_card.png')" data-app="Ghostmark" data-internal-Link="/Ghostmark/">
        <h3>Ghostmark</h3>
        <p>Uncover images inside another hidden with Ghostmark.</p>
        <a href="/Ghostmark/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/Carbbels_card.png')" data-app="Carbbels" data-internal-Link="/Carbbels/">
        <h3>Carbbels</h3>
        <p>Experiment with anagram layouts and spatial letter reasoning.</p>
        <a href="/Carbbels/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/WordFlux_card.png')" data-app="WordFlux" data-internal-Link="/WordFlux/">
        <h3>WordFlux</h3>
        <p>Practice word pattern recognition and deduction with fast feedback.</p>
        <a href="/WordFlux/" class="card-link-visually-hidden">Launch</a>
      </div>
    </div>
  </section>

  <!-- Creator Tools -->
  <section id="creator-tools" class="reveal">
    <h2 class="section-title">Creator Tools</h2>
    <p class="section-sub">Hide meaning. Build mysteries. Shape the experience.</p>
    <div class="grid">
      <div class="card has-bg" style="--bg: url('./assets/images/WordLoom_card.png')" data-app="WordLoom" data-internal-Link="/WordLoom/">
        <h3>WordLoom</h3>
        <p>Weave crosswords quickly for puzzle prototyping and clue delivery.</p>
        <a href="/WordLoom/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/SpectroGhost_card.png')" data-app="SpectroGhost" data-internal-Link="/SpectroGhost/">
        <h3>SpectroGhost</h3>
        <p>Create spectrograms of audio you want players to reconstruct with ReSounder.</p>
        <a href="/SpectroGhost/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/SonoGlyph_card.png')" data-app="SonoGlyph" data-internal-Link="/SonoGlyph/">
        <h3>SonoGlyph</h3>
        <p>Embed visual art into audio spectrograms using spectral synthesis.</p>
        <a href="/SonoGlyph/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/Ghostmark_card.png')" data-app="Ghostmark" data-internal-Link="/Ghostmark/">
        <h3>Ghostmark</h3>
        <p>Hide a secret image inside another using seeded steganography.</p>
        <a href="/Ghostmark/" class="card-link-visually-hidden">Launch</a>
      </div>
    </div>
  </section>

  <!-- Analyst & Experimental Tools -->
  <section id="analyst-tools" class="reveal">
    <h2 class="section-title">Analyst and Sandbox Tools</h2>
    <p class="section-sub">Explore new mechanics. Decode the unknown. Experiment freely.</p>
    <div class="grid">
      <div class="card has-bg" style="--bg: url('./assets/images/SpectroGhost_card.png')" data-app="SpectroGhost" data-internal-Link="/SpectroGhost/">
        <h3>SpectroGhost</h3>
        <p>A fast signal investigation app for deep audio sleuthing.</p>
        <a href="/SpectroGhost/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/ReSounder_card.png')" data-app="ReSounder" data-internal-Link="/ReSounder/">
        <h3>ReSounder</h3>
        <p>Understand and exploit the link between images and audio.</p>
        <a href="/ReSounder/" class="card-link-visually-hidden">Launch</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/Carbbels_card.png')" data-app="Carbbels" data-internal-Link="/Carbbels/">
        <h3>Carbbels</h3>
        <p>Experiment with anagram layouts and spatial letter reasoning.</p>
        <a href="/Carbbels/" class="card-link-visually-hidden">Launch</a>
      </div>
    </div>
  </section>

  <!-- The Zodiac ARG Section -->
  <section id="zodiac-arg" class="reveal">
    <h2 class="section-title">The Zodiac Killer's ARG</h2>
    <p class="section-sub">Uncover the mysteries. Follow the breadcrumbs. Solve the cipher.</p>
    <div class="grid">
      <div class="card has-bg" style="--bg: url('./assets/images/zodiac-links_card.png')" data-app="zodiac-links" data-internal-Link="/notion-links.html?src=https://nqrlabs.notion.site/ebd/28dafee319508082ab9eedd14d648567?v=28dafee31950813e889a000c558182e8">
        <h3>The Zodiac Killer Link Vault</h3>
        <p>Collected findings, decoded messages, and community contributions.</p>
        <a href="/notion-links.html?src=https://nqrlabs.notion.site/ebd/28dafee319508082ab9eedd14d648567?v=28dafee31950813e889a000c558182e8" class="card-link-visually-hidden">Browse Archive</a>
      </div>
      <div class="card has-bg" style="--bg: url('./assets/images/zodiac-timeline_card.png')" data-app="zodiac-timeline" data-internal-Link="/notion-links.html?src=https://nqrlabs.notion.site/ebd/285afee319508004b709dedb52644e75?v=285afee3195080deb3a0000c2bf6abac">
        <h3>Zodiac Timeline</h3>
        <p>A comprehensive timeline of discoveries, clues, and revelations.</p>
        <a href="/notion-links.html?src=https://nqrlabs.notion.site/ebd/285afee319508004b709dedb52644e75?v=285afee3195080deb3a0000c2bf6abac" class="card-link-visually-hidden">View Timeline</a>

      </div>
    </div>
  </section>

  <section id="latest-updates" class="reveal">
    <h2 class="section-title">Latest GitHub Updates</h2>
    <p class="section-sub">Recent GitHub activity from NQR Labs</p>
    <div id="updates-container" class="grid"></div>
  </section>

  <section class="about reveal">
    This is where puzzle solvers and puzzle builders meet. Join the CLU community to collaborate on stories, ciphers, hidden signals, and new ways to reveal what should never be obvious at first glance. Learn. Create. Test ideas. Share discoveries. The rabbit holes go deeper when we explore them together.
  </section>

  <footer>
    <a href="https://www.youtube.com/@CLU-NQR" target="_blank">YouTube</a>
    <a href="https://discord.gg/HT9YE8rvuN" target="_blank">Discord</a>
    <a href="https://github.com/NQRLabs" target="_blank">GitHub</a>
    <p></p>
    <span>Copyright (c) <span id="year"></span> NQR Labs</span>
  </footer>
</div>

<!-- Iframe Viewer -->
<div id="iframe-viewer">
  <iframe id="content-frame"></iframe>
</div>

<!-- Navigation Sidebar -->
<div id="nav-sidebar">
  <div class="nav-header">
    <img src="./assets/images/logo.png" alt="NQR Labs">
    <h3>Navigation</h3>
  </div>
  
  <div class="nav-section">
    <div class="nav-section-title">Main</div>
    <a href="#" class="nav-link" data-scroll-to="home">Home</a>
    <a href="#" class="nav-link" id="about">About NQR Labs</a>
    <a href="#" class="nav-link" id="help">Help & Tips</a>
  </div>
  
  <div class="nav-section">
    <div class="nav-section-title">Jump to Section</div>
    <a href="#" class="nav-link" data-scroll-to="player-tools">Player Tools</a>
    <a href="#" class="nav-link" data-scroll-to="creator-tools">Creator Tools</a>
    <a href="#" class="nav-link" data-scroll-to="analyst-tools">Analyst Tools</a>
    <a href="#" class="nav-link" data-scroll-to="zodiac-arg">Zodiac ARG</a>
    <a href="#" class="nav-link" data-scroll-to="latest-updates">Latest GitHub Updates</a>
  </div>
  
  <div class="nav-section">
    <div class="nav-section-title">Connect</div>
    <a href="https://www.youtube.com/@CLU-NQR" target="_blank" class="nav-link">YouTube</a>
    <a href="https://discord.gg/HT9YE8rvuN" target="_blank" class="nav-link">Discord</a>
    <a href="https://github.com/NQRLabs" target="_blank" class="nav-link">GitHub</a>
  </div>
</div>

<!-- Hamburger Toggle -->
<div class="nav-toggle" id="nav-toggle">
  <div class="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<!-- About NQR Modal -->
<div id="about-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">About NQR Labs</h2>
      <button class="close-btn" onclick="closeModal('about-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <p><strong>NQR Labs</strong> is the creative workspace of a puzzle designer, ARG creator, and mystery engineer who lives for the thrill of hidden layers and encoded stories.</p>
      
      <h3>Creative Philosophy</h3>
      <p>Every puzzle should feel like discovering a real rabbit hole hidden in plane sight. The best mysteries respect the solver's intelligence while rewarding persistence, lateral thinking, and collaboration.</p>
      
      <h3>Community</h3>
      <p>These tools are built for the <strong>CLU community</strong>—a collective of puzzle enthusiasts, ARG hunters, and cipher breakers who believe that the best challenges are solved together.</p>
      
      <h3>What makes an ARG</h3>
      <p>An Alternate Reality Game (ARG) is essentially puzzle-driven interactive unfiction. These experiences are at their best when a community forms around them - sharing discoveries, solving puzzles collaboratively, and uncovering hidden narratives together. The CLU community thrives on this collective spirit, bringing together both players and creators in a shared creative space. Here, ARG creators can test new ideas, gather live feedback, and refine their worlds, while solvers work side by side with them to unravel mysteries and shape stories as they unfold. Whether the puzzles emerge from within our own ranks or from ARGs found out in the wider web, the hunt is always open, and collaboration is always encouraged.</p>
      
      <h3>Get Involved</h3>
      <p>Follow on <a href="https://www.youtube.com/@CLU-NQR" target="_blank">YouTube</a> for deep dives into creative tools, ARG walkthroughs, and lessons that lead you further down the rabbit hole.</p>

      <p>Join the <a href="https://discord.gg/HT9YE8rvuN" target="_blank">CLU Discord</a> to collaborate on mysteries, share techniques, and participate in community ARGs.</p>
      
      <p>Follow on <a href="https://github.com/NQRLabs" target="_blank">GitHub</a> for open-source puzzle tools and experimental projects.</p>
    </div>
  </div>
</div>

<!-- Help Modal -->
<div id="help-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">Help & Tips</h2>
      <button class="close-btn" onclick="closeModal('help-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <h3>Welcome</h3>
      <p>Think of NQR Labs as a playground for creative exploration - a space where curiosity leads the way. Whether you're experimenting with new tools, diving into interactive stories, or learning how digital puzzles come together, you're in good company here.</p>
    
      <h3>Collaboration</h3>
      <p>The most interesting discoveries happen when people share what they find. Discuss ideas, trade insights, and build on each other's work. This is a community for explorers, makers, and storytellers alike - and you're invited to take part in shaping it.</p>
    
      <h3>Learning & Experimentation</h3>
      <p>Many of the projects here are works in progress - experiments in storytelling, design, and interaction. Don't be afraid to click around, test things, or remix ideas. It's all part of the process.</p>
  
      <h3>Stay Connected</h3>
      <ul style="text-align: left; padding-left: 20px;">
        <li>Join the conversation on <a href="https://discord.gg/HT9YE8rvuN" target="_blank">Discord</a>. Share feedback, discuss ideas, or find collaborators.</li>
        <li>Follow on <a href="https://youtube.com/@CLU-NQR" target="_blank">YouTube</a> for tutorials, experiments, and guided explorations.</li>
        <li>Report bugs or contribute improvements on <a href="https://github.com/NQRLabs" target="_blank">GitHub</a>.</li>
      </ul>
    </div>
  </div>
</div>

<script>
  (function () {
    // 1) try ?app=data-app
    const params = new URLSearchParams(window.location.search);
    let app = params.get('app');

    // 2) or #data-app
    if (!app && window.location.hash) app = window.location.hash.slice(1);
    if (!app) return;

    // Find the right card
    const card = document.querySelector(`[data-app="${app}"]`);
    if (!card) return;

    const url = getUrlFromCard(card);
    if (url) loadInIframe(url);
  })();

  // Reveal on scroll
  function revealOnScroll() {
    const reveals = document.querySelectorAll('.reveal');
    const viewport = window.innerHeight;
    reveals.forEach(el => {
      const rect = el.getBoundingClientRect();
      if (rect.top < viewport - 50) {
        el.classList.add('visible');
      }
    });
  }
  
  window.addEventListener('scroll', revealOnScroll);
  window.addEventListener('load', revealOnScroll);
  window.addEventListener('popstate', function (event) {
    const viewer = document.getElementById('iframe-viewer');
    
    // Only intercept if we’re *still* in iframe view AND the new URL has no hash or an app hash
    const hash = window.location.hash.slice(1);
    const sectionIds = ['home', 'player-tools', 'creator-tools', 'analyst-tools', 'zodiac-arg', 'latest-updates', 'about', 'help'];
  
    if (viewer.classList.contains('active') && (!hash || !sectionIds.includes(hash))) {
      // If the hash isn’t a main section (i.e., likely navigating away from app)
      returnHome(hash);
    }
  });


  window.addEventListener('hashchange', () => {
    const app = window.location.hash.slice(1);
    if (!app) return;
  
    const card = document.querySelector(`[data-app="${app}"]`);
    if (!card) return;
  
    const url = getUrlFromCard(card);
    if (url) loadInIframe(url);
  });

  document.getElementById('year').textContent = new Date().getFullYear();

  // Load latest GitHub updates
  async function loadLatestUpdates() {
    const container = document.getElementById('updates-container');
    const username = 'NQRLabs';
    const maxItems = 4;
  
    try {
      const res = await fetch(`https://api.github.com/users/${username}/repos?sort=updated`);
      const repos = await res.json();
      const real = repos.filter(r => !r.fork);
      const latest = real.slice(0, maxItems);
  
      container.innerHTML = '';
      latest.forEach(repo => {
        const card = document.createElement('div');
        card.className = 'card reveal';
        const updated = new Date(repo.updated_at).toLocaleDateString();
        card.innerHTML = `
          <h3>${repo.name}</h3>
          <p>Last updated: ${updated}</p>
          <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer" class="card-link-visually-hidden">View Repo</a>
        `;
        container.appendChild(card);
      });
    } catch (e) {
      container.innerHTML = '<p>Unable to load updates right now.</p>';
    }
  }
  
  loadLatestUpdates();

  // Card click handling
  function enableCardClicks(scope) {
    var root = scope || document;
    var cards = root.querySelectorAll('.card');
  
    cards.forEach(function(card){
      if (card.dataset.clickBound === '1') return;
  
      var link = card.querySelector('a[href]');
      if (!link) return;
  
      card.setAttribute('role', 'link');
      card.setAttribute('tabindex', '0');
      var h3 = card.querySelector('h3');
      if (h3 && !card.getAttribute('aria-label')) {
        card.setAttribute('aria-label', h3.textContent.trim());
      }
  
      function activate(e) {
        var href = link.getAttribute('href');
        var target = (link.getAttribute('target') || '').toLowerCase();
        var internalLink = card.dataset.internalLink;
        
        // Check if Ctrl/Cmd is held - if so, open in new tab regardless
        if (e && (e.ctrlKey || e.metaKey)) {
          window.open(href, '_blank', 'noopener,noreferrer');
          return;
        }
        
        // If marked as internal, load in iframe
        if (internalLink) {
          loadInIframe(internalLink);
          return;
        }
  
        // External link - open in new tab
        if (target === '_blank') {
          window.open(href, '_blank', 'noopener,noreferrer');
        } else {
          window.location.href = href;
        }
      }
  
      card.addEventListener('click', function(e){
        if (e.target.closest('a, button, input, textarea, select')) return;
        activate(e);
      });
  
      card.addEventListener('keydown', function(e){
        var key = e.key || e.code;
        if (key === 'Enter' || key === ' ') {
          e.preventDefault();
          activate(e);
        }
      });
  
      card.dataset.clickBound = '1';
    });
  }
  
  enableCardClicks(document);
  
  // Re-run after Latest Updates are injected
  (async function(){
    try {
      await loadLatestUpdates();
    } catch (err) {
      // ignore
    } finally {
      var updates = document.getElementById('updates-container');
      if (updates) enableCardClicks(updates);
    }
  })();

  // Iframe viewer functions
  function loadInIframe(url) {
    const viewer = document.getElementById('iframe-viewer');
    const frame = document.getElementById('content-frame');
    const mainContent = document.getElementById('main-content');
    
    frame.src = url;
    viewer.classList.add('active');
    mainContent.classList.add('hidden');
    
    // Disable scroll on main page
    document.body.style.overflow = 'hidden';

    // add a state to history so Back will return here
    // Update URL hash if loading from a card with data-app attribute
    const appName = document.querySelector(`[data-internal-link="${url}"]`)?.dataset?.app;
    if (appName) {
      history.replaceState(null, '', '#' + appName);
    }
  }

  function getUrlFromCard(card) {
    let url =
      card.dataset.externalUrl ||
      card.dataset.internalUrl ||
      card.dataset.internalLink ||
      card.dataset.internallink ||
      card.dataset.url;
  
    if (!url) {
      url =
        card.getAttribute('data-external-url') ||
        card.getAttribute('data-internal-url') ||
        card.getAttribute('data-internal-link') ||
        card.getAttribute('data-internal-Link') ||
        card.getAttribute('data-url');
    }
  
    if (!url) return null;
  
    // ?? leave the URL alone here � it's often /notion-links.html?src=...
    if (!/^https?:\/\//i.test(url)) {
      if (url.startsWith('/')) {
        url = window.location.origin + url;
      } else {
        url = window.location.origin + '/' + url;
      }
    }
  
    return url;
  }

  // 3) open by app id
  function openByAppId(app) {
    if (!app) return;
    const card = document.querySelector(`[data-app="${app}"]`);
    if (!card) {
      return;
    }
    const url = getUrlFromCard(card);
    if (url) loadInIframe(url);
  }

  // Hash-based routing
  function handleRoute() {
    const hash = window.location.hash.slice(1); // Remove the #
    
    // No hash - show homepage at top
    if (!hash) {
      returnHome(null);
      return;
    }
    
    // Handle About and Help modals
    if (hash === 'about') {
      openModal('about-modal');
      closeSidebar();
      return;
    }
    if (hash === 'help') {
      openModal('help-modal');
      closeSidebar();
      return;
    }

    // Check if it's a section on the main page
    const sectionIds = ['home', 'player-tools', 'creator-tools', 'analyst-tools', 'zodiac-arg', 'latest-updates'];
    if (sectionIds.includes(hash)) {
      const inIframe = document.getElementById('iframe-viewer').classList.contains('active');
      if (inIframe) returnHome(hash);
  
      setTimeout(() => {
        const target = document.getElementById(hash);
        if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        closeSidebar();
      }, inIframe ? 400 : 0);
  
      return;
    }
    // Otherwise, treat it as an app/content to load in iframe
    openByAppId(hash);
  }

  // Run on page load
  window.addEventListener('DOMContentLoaded', handleRoute);

  // Run when hash changes
  window.addEventListener('hashchange', handleRoute);

  function returnHome(targetHash) {
    const viewer = document.getElementById('iframe-viewer');
    const frame = document.getElementById('content-frame');
    const mainContent = document.getElementById('main-content');
    const sidebar = document.getElementById('nav-sidebar');
    const navToggle = document.getElementById('nav-toggle');
  
    viewer.classList.remove('active');
    mainContent.classList.remove('hidden');
    sidebar.classList.remove('open');
    navToggle.classList.remove('open');
    document.body.style.overflow = '';
  
    // clear iframe after transition
    setTimeout(() => {
      frame.src = '';
    }, 300);
  
    // interpret the argument
    if (targetHash === null || targetHash === '' || targetHash === '#') {
      // "no hash" -> stay on current path
      history.replaceState(null, '', window.location.pathname);
    } else if (typeof targetHash === 'string') {
      // normalize: accept 'zodiac-arg' or '#zodiac-arg'
      const clean = targetHash.replace(/^#/, '');
      history.replaceState(null, '', '#' + clean);
    } else {
      // fallback to old behavior
      history.replaceState(null, '', '#home');
    }
  }

  function closeSidebar() {
    document.getElementById('nav-sidebar').classList.remove('open');
    document.getElementById('nav-toggle').classList.remove('open');
  }

  // Navigation toggle
  document.getElementById('nav-toggle').addEventListener('click', function() {
    const sidebar = document.getElementById('nav-sidebar');
    const toggle = document.getElementById('nav-toggle');
    sidebar.classList.toggle('open');
    toggle.classList.toggle('open');
  });

  // Scroll to section links
  document.querySelectorAll('[data-scroll-to]').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.dataset.scrollTo;
      
      // Update the hash, which will trigger handleRoute
      window.location.hash = targetId;
      //closeSidebar();
    });
  });

  // Nav home button
  document.getElementById('home').addEventListener('click', function(e) {
    e.preventDefault();
    window.location.hash = 'home';
    closeSidebar();
  });

  // Modal functions
  document.getElementById('about').addEventListener('click', function(e) {
    e.preventDefault();
    openModal('about-modal');
    closeSidebar();
  });

  document.getElementById('help').addEventListener('click', function(e) {
    e.preventDefault();
    openModal('help-modal');
    closeSidebar();
  });

  function openModal(modalId) {
    document.getElementById(modalId).classList.add('active');
  }

  function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
  }

  // Close modals on background click
  document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        closeModal(modal.id);
      }
    });
  });

  // Close modals on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      document.querySelectorAll('.modal.active').forEach(modal => {
        closeModal(modal.id);
      });
    }
  });
</script>

</body>
</html>
